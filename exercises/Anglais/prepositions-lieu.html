<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Anglais - Prepositions</title>
    <style>
      :root {
        --bg: #0f1115;
        --ink: #e8e6e3;
        --muted: #b7b3ad;
        --accent: #8ab4f8;
        --card: #171a21;
        --border: #2a2f3a;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: "IBM Plex Serif", "Georgia", serif;
        background: var(--bg);
        color: var(--ink);
        padding: 32px;
      }
      a { color: var(--accent); }
      header { max-width: 820px; margin: 0 auto 20px; }
      h1 { margin: 0 0 6px; font-size: 2rem; }
      p { margin: 0; color: var(--muted); }
      main { max-width: 820px; margin: 0 auto; }
      .card {
        background: var(--card);
        border: 1px solid var(--border);
        padding: 18px;
        margin-bottom: 16px;
      }
      select {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border);
        background: #121419;
        color: var(--ink);
        margin-top: 10px;
      }
      .feedback { color: var(--muted); margin-top: 8px; }
      .feedback.good { color: #8bd99f; }
      .feedback.bad { color: #f28b82; }
      button {
        padding: 10px 14px;
        font-size: 1rem;
        border: 1px solid var(--border);
        background: #121419;
        color: var(--ink);
        cursor: pointer;
      }
      button:hover { border-color: var(--accent); }
      .result { font-weight: bold; color: var(--muted); margin-top: 10px; }
      .actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
      .series { color: var(--muted); font-size: 0.9rem; }
    </style>
  </head>
  <body>
    <header>
      <p><a href="intro.html">Retour Anglais</a></p>
      <h1>&#128205; Prepositions de lieu</h1>
      <p>Choisis la bonne preposition.</p>
    </header>
    <main>
      <div class="card">
        <strong id="q1-label"></strong>
        <select id="q1"></select>
      </div>
      <div class="card">
        <strong id="q2-label"></strong>
        <select id="q2"></select>
      </div>
      <div class="card">
        <strong id="q3-label"></strong>
        <select id="q3"></select>
      </div>
      <div class="card">
        <strong id="q4-label"></strong>
        <select id="q4"></select>
      </div>
      <div class="card">
        <strong id="q5-label"></strong>
        <select id="q5"></select>
      </div>
      <div class="actions">
        <button id="check">Verifier</button>
        <button id="next">Autre serie</button>
        <span class="series" id="series"></span>
      </div>
      <p class="result" id="result" aria-live="polite"></p>
    </main>
    <script>
      const sets = [
        [
          {
            label: "The library is ___ the cafeteria and the gym.",
            options: ["between", "under", "behind", "on"],
            answer: "between",
            explain: "Between s'utilise pour deux lieux: entre A et B.",
          },
          {
            label: "The playground is ___ the school.",
            options: ["in front of", "under", "between", "behind"],
            answer: "in front of",
            explain: "In front of = devant, opposite de behind.",
          },
          {
            label: "The gym is ___ the library.",
            options: ["next to", "behind", "in", "on"],
            answer: "next to",
            explain: "Next to = a cote de.",
          },
          {
            label: "The car park is ___ the school building.",
            options: ["behind", "on", "between", "under"],
            answer: "behind",
            explain: "Behind = derriere.",
          },
          {
            label: "The art room is ___ the first floor.",
            options: ["on", "under", "between", "in front of"],
            answer: "on",
            explain: "On the first floor: on + etage.",
          },
        ],
        [
          {
            label: "The cafeteria is ___ the gym and the library.",
            options: ["between", "under", "behind", "on"],
            answer: "between",
            explain: "Between s'utilise pour deux lieux.",
          },
          {
            label: "The main entrance is ___ the school.",
            options: ["in front of", "under", "between", "behind"],
            answer: "in front of",
            explain: "In front of = devant.",
          },
          {
            label: "The music room is ___ the art room.",
            options: ["next to", "behind", "in", "on"],
            answer: "next to",
            explain: "Next to = a cote de.",
          },
          {
            label: "The stadium is ___ the school.",
            options: ["behind", "on", "between", "under"],
            answer: "behind",
            explain: "Behind = derriere.",
          },
          {
            label: "The library is ___ the ground floor.",
            options: ["on", "under", "between", "in front of"],
            answer: "on",
            explain: "On + floor.",
          },
        ],
        [
          {
            label: "The science lab is ___ the gym and the cafeteria.",
            options: ["between", "under", "behind", "on"],
            answer: "between",
            explain: "Between = entre deux lieux.",
          },
          {
            label: "The car park is ___ the school.",
            options: ["in front of", "under", "between", "behind"],
            answer: "in front of",
            explain: "In front of = devant.",
          },
          {
            label: "The library is ___ the classrooms.",
            options: ["next to", "behind", "in", "on"],
            answer: "next to",
            explain: "Next to = a cote de.",
          },
          {
            label: "The art room is ___ the hall.",
            options: ["behind", "on", "between", "under"],
            answer: "behind",
            explain: "Behind = derriere.",
          },
          {
            label: "The gym is ___ the first floor.",
            options: ["on", "under", "between", "in front of"],
            answer: "on",
            explain: "On + floor.",
          },
        ],
      ];

      const button = document.getElementById("check");
      const result = document.getElementById("result");
      const next = document.getElementById("next");
      const series = document.getElementById("series");
      const labels = [
        document.getElementById("q1-label"),
        document.getElementById("q2-label"),
        document.getElementById("q3-label"),
        document.getElementById("q4-label"),
        document.getElementById("q5-label"),
      ];
      const selects = [
        document.getElementById("q1"),
        document.getElementById("q2"),
        document.getElementById("q3"),
        document.getElementById("q4"),
        document.getElementById("q5"),
      ];
      let current = Math.floor(Math.random() * sets.length);

      const shuffle = (items) => {
        const copy = items.slice();
        for (let i = copy.length - 1; i > 0; i -= 1) {
          const j = Math.floor(Math.random() * (i + 1));
          [copy[i], copy[j]] = [copy[j], copy[i]];
        }
        return copy;
      };

      const renderSet = (index) => {
        result.textContent = "";
        series.textContent = `Serie ${index + 1}/3`;
        sets[index].forEach((item, i) => {
          labels[i].textContent = item.label;
          selects[i].dataset.answer = item.answer;
          selects[i].dataset.explain = item.explain;
          selects[i].innerHTML = "";
          const placeholder = document.createElement("option");
          placeholder.value = "";
          placeholder.textContent = "-- Choisir --";
          selects[i].appendChild(placeholder);
          shuffle(item.options).forEach((opt) => {
            const option = document.createElement("option");
            option.textContent = opt;
            selects[i].appendChild(option);
          });
          const feedback = selects[i].parentElement.querySelector(".feedback");
          if (feedback) {
            feedback.textContent = "";
            feedback.classList.remove("good", "bad");
          }
        });
      };

      renderSet(current);

      button.addEventListener("click", () => {
        let score = 0;
        selects.forEach((select) => {
          let feedback = select.parentElement.querySelector(".feedback");
          if (!feedback) {
            feedback = document.createElement("p");
            feedback.className = "feedback";
            select.parentElement.appendChild(feedback);
          }
          if (!select.value) {
            feedback.textContent = "Choisis une reponse.";
            feedback.classList.remove("good", "bad");
            return;
          }
          if (select.value === select.dataset.answer) {
            feedback.textContent = "Correct.";
            feedback.classList.remove("bad");
            feedback.classList.add("good");
            score += 1;
          } else {
            feedback.textContent = `Faux: ${select.dataset.explain}`;
            feedback.classList.remove("good");
            feedback.classList.add("bad");
          }
        });
        result.textContent = `Score: ${score}/${selects.length}`;
      });

      next.addEventListener("click", () => {
        let index = current;
        while (index === current && sets.length > 1) {
          index = Math.floor(Math.random() * sets.length);
        }
        current = index;
        renderSet(current);
      });
    </script>
  </body>
</html>
